# Claude Container Integration Test Environment
# Copy to .env.test and configure for your environment
#
# SECURITY: The actual .env.test sources credentials from parent directory
# and should NOT be committed to git (it's in .gitignore)

set -a

# Clear any stale environment variables
unset DB_SERVER DB_DATABASE DB_USERNAME DB_PASSWORD
unset ANTHROPIC_API_KEY

# =============================================================================
# Option 1: Source from parent directory (RECOMMENDED)
# =============================================================================
# Create a ../.env file with your credentials:
#   DB_SERVER=mssql.local
#   DB_USERNAME=SA
#   DB_PASSWORD=YourPassword
#   ANTHROPIC_API_KEY=sk-ant-...  # Optional, can use OAuth instead
#
# Then this file will source them automatically:
if [ -f "${PROJECT_ROOT}/../.env" ]; then
    source "${PROJECT_ROOT}/../.env"
elif [ -f "../.env" ]; then
    source "../.env"
fi

# =============================================================================
# Option 2: Set directly (NOT recommended for shared repos)
# =============================================================================
# DB_SERVER="mssql.local"
# DB_USERNAME="SA"
# DB_PASSWORD="YourPassword"
# ANTHROPIC_API_KEY="sk-ant-..."

# =============================================================================
# Test database configuration
# =============================================================================
# Test database (will be created if doesn't exist)
DB_DATABASE="${DB_DATABASE:-claude_container_test}"

# ODBC settings
DB_DRIVER="${DB_DRIVER:-ODBC Driver 18 for SQL Server}"
DB_TRUST_CERT="${DB_TRUST_CERT:-yes}"

# =============================================================================
# Claude Code authentication
# =============================================================================
# Two authentication methods supported:
#
# Method 1: API Key (for CI/CD or direct API access)
#   Set ANTHROPIC_API_KEY in parent .env or export directly
#   ANTHROPIC_API_KEY="sk-ant-api03-..."
#
# Method 2: OAuth credentials (for local testing)
#   Mount your ~/.claude directory into the container
#   This shares your existing Claude Code OAuth session
#   Example: -v ~/.claude:/home/claude/.claude:ro

CLAUDE_CONFIG_DIR="${CLAUDE_CONFIG_DIR:-$HOME/.claude}"

set +a
