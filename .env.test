# Claude Container Integration Test Environment
# Sources credentials from parent directory for security

set -a

# Clear any stale environment variables
unset DB_SERVER DB_DATABASE DB_USERNAME DB_PASSWORD
unset ANTHROPIC_API_KEY

# Source base credentials from parent directory
# Expected variables: DB_SERVER, DB_USERNAME, DB_PASSWORD
if [ -f "${PROJECT_ROOT}/../.env" ]; then
    source "${PROJECT_ROOT}/../.env"
elif [ -f "../.env" ]; then
    source "../.env"
elif [ -f "~/.env" ]; then
    source "~/.env"
fi

# Test database (created if doesn't exist)
DB_DATABASE="${DB_DATABASE:-claude_container_test}"

# ODBC settings
DB_DRIVER="${DB_DRIVER:-ODBC Driver 18 for SQL Server}"
DB_TRUST_CERT="${DB_TRUST_CERT:-yes}"

# Claude Code authentication
# Option 1: API key (for CI/CD or direct API access)
#   Set ANTHROPIC_API_KEY in parent .env or export directly
# Option 2: OAuth credentials (for local testing)
#   Mount ~/.claude directory into container
CLAUDE_CONFIG_DIR="${CLAUDE_CONFIG_DIR:-$HOME/.claude}"

set +a
